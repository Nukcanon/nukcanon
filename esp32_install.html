<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESP32 개발환경 설정 및 핀배열</title>
    <link rel="stylesheet" href="css/style.css" />
    <style>
        .content-container {
            max-width: 960px;
            margin: 0 auto;
            padding: 20px;
        }
        .section-title {
            margin-top: 40px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color, #ddd); /* fallback added */
            color: var(--primary-color, #333); /* fallback added */
        }
        .step-img {
            max-width: 100%;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 10px auto;
            display: block;
        }
        .pin-list li {
            margin-bottom: 5px;
        }
        .wiring-table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 20px;
            font-size: 0.95rem;
        }
        .wiring-table th, .wiring-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
            vertical-align: middle;
        }
        .wiring-table th {
            background-color: #f2f2f2;
            font-weight: bold;
            text-align: center;
            color: #333;
        }
        .wiring-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .summary-img-container {
            text-align: center;
            margin: 20px 0;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 8px;
        }
        .summary-label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }

        /* --- [수정됨] 주소 복사 기능을 위한 스타일 추가 --- */
        .url-copy-container {
            background: #f4f4f4;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            margin: 10px 0;
        }
        .url-copy-container code {
            word-break: break-all;
            font-family: Consolas, monospace;
            color: #d63384; /* 강조색 */
            font-size: 0.9em;
            background-color: #fff;
            padding: 4px 8px;
            border-radius: 4px;
            border: 1px solid #eee;
            flex-grow: 1; /* 남은 공간 차지 */
        }
        .copy-btn {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            white-space: nowrap;
            transition: background-color 0.2s;
        }
        .copy-btn:hover {
            background-color: #0056b3;
        }
        .copy-btn:active {
            background-color: #004494;
        }
    </style>
</head>
<body>

    <div class="topbanner">
        <div style="align-self:stretch;width:960px;display:flex; flex-direction: row;">
            <div style="flex:99999">
                <label>Nukcanon</label>
            </div>
            <div>
                <a target="_self" href="./index.html">Home</a>
            </div>
        </div>
    </div>

    <div class="content-container">
        <h2>Arduino 개발도구(IDE)에서 ESP32 보드 사용 설정</h2>

        <h3 class="section-title">1. Arduino 개발도구를 이용한 설정 방법</h3>
        
        <div class="step-list">
            <ol>
                <li>
                    <strong>File > Preferences</strong>를 클릭합니다.
                    <img src="image/arduino_pref_1.png" alt="File > Preferences 메뉴" class="step-img" style="max-width: 75%;">
                </li>
                <li>
                    <strong>Additional Board Manager URLs</strong>의 오른쪽 아이콘을 클릭하고, 아래 주소를 추가한 후 <strong>OK</strong>를 누릅니다.
                    
                    <div class="url-copy-container">
                        <code id="esp32-url">https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json</code>
                        <button onclick="copyUrl()" class="copy-btn">주소 복사</button>
                    </div>

                    <img src="image/arduino_pref_2.png" alt="Board Manager URL 입력 화면" class="step-img">
                </li>
                <li>
                    <strong>Tools > Board > Boards Manager</strong>를 클릭합니다. 검색창에 <code>esp32</code>를 검색하여, <strong>ESP32 by Espressif Systems</strong>를 찾아 그 아래의 <strong>Install</strong>을 클릭합니다.
                    <p class="callout callout-danger">
                        <span class="callout-title">⚠️ 주의!</span>
                        반드시 <strong>프로젝트에 맞는 버전</strong>(2.0.17 혹은 3.1.3 버전)을 선택하여 설치해주세요!
                    </p>
                    <img src="image/board_manager.png" alt="Board Manager 설치 화면" class="step-img">
                </li>
                <li>
                    <strong>Tools > Board</strong> 메뉴에서 가지고 있는 ESP32의 모델을 찾아 클릭하고, <strong>Tools > Port</strong> 메뉴에서 ESP32가 연결된 포트를 선택합니다.
                    <img src="image/board_port_select.png" alt="보드 및 포트 선택 화면" class="step-img">
                </li>
            </ol>
        </div>

        <div class="callout callout-warning">
            <span class="callout-title">주의 사항</span>
            ESP32는 Arduino와 기본 명령어(<code>pinMode</code>, <code>digitalWrite</code>, <code>digitalRead</code> 등)는 동일하나, <strong>Wi-Fi, Servo 모터 등의 명령어는 다르므로</strong>, <em>Sketch > Include Library > Manage Libraries</em>에서 해당 라이브러리를 찾아 등록해야 합니다.
        </div>

        <h3 class="section-title">2. ESP32 핀배열 (Pinout)</h3>
        <p>ESP32는 Arduino와 핀배열이 다릅니다. DOIT ESP32 DEVKIT 30핀 기준으로 다음과 같습니다.</p>
        
        <img src="image/esp32_pinout.png" alt="ESP32 Pinout Diagram" class="step-img">

        <h4>가. GPIO (General-Purpose Input/Output) 상세 안내</h4>
        <p>디지털 입출력 핀으로 입력 및 출력이 가능합니다. 단, 목적이 정해진 핀이 있어 주의해야 합니다.</p>
        
        <table class="wiring-table">
            <thead>
                <tr>
                    <th width="30%">구분</th>
                    <th>해당 핀 (GPIO)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>사용 가능 핀</strong><br>(제약 없음)</td>
                    <td>GPIO 4, 13, 14, 16~33</td>
                </tr>
                <tr>
                    <td><strong>내부 LED 연결</strong></td>
                    <td>GPIO 2</td>
                </tr>
                <tr>
                    <td><strong>입력 전용 (Read-Only)</strong></td>
                    <td>GPIO 34~39</td>
                </tr>
                <tr>
                    <td><strong>플래시 메모리 전용</strong><br>(사용 불가)</td>
                    <td>GPIO 6~11</td>
                </tr>
            </tbody>
        </table>

        <div class="summary-img-container">
            <span class="summary-label">▼ 사용 가능한 GPIO 핀 정리</span>
            <img src="image/esp32_gpio_summary.png" alt="ESP32 사용 가능한 GPIO 핀 정리" class="step-img" style="max-width: 40%;">
        </div>

        <h4>나. ADC (Analog to Digital Converter)</h4>
        <p>아날로그 신호를 디지털로 변환해주는 핀입니다. 0V~3.3V를 0~4095까지 총 4096단계로 변환하며, Arduino의 <code>analogRead</code>에 대응합니다.</p>

        <h4>다. PWM (Pulse Width Modulation)</h4>
        <p>디지털 신호의 펄스 폭을 조절하여 제어합니다. <code>analogWrite</code>(최근 지원) 혹은 <code>ledcWrite</code>(기본 지원)를 사용하며 서보 모터 제어 등에 사용됩니다.</p>

        <h3 class="section-title">3. ESP32-CAM 핀배열</h3>
        <p>ESP32-CAM은 일반 ESP32와 핀배열이 다릅니다. (16핀 기준)</p>
        <p>아래 GPIO 핀으로 입출력 하면 되지만, <strong>GPIO 0, 1, 3</strong>은 컴퓨터와 연결 시 사용되므로 사용하지 않는 것이 좋으며, 주의해야 할 핀이 많으므로 확인이 필요합니다.</p>

        <img src="image/esp32_cam_pinout.png" alt="ESP32-CAM Pinout Diagram" class="step-img">

        <h4>가. GPIO (General-Purpose Input/Output)</h4>
        <table class="wiring-table">
            <thead>
                <tr>
                    <th width="30%">구분</th>
                    <th>해당 핀 (GPIO)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>SD 카드 공유 핀</strong><br>(SD 미사용 시 사용 가능)</td>
                    <td>GPIO 2, 4, 12, 13, 14, 15</td>
                </tr>
                <tr>
                    <td><strong>내부 LED 및 플래시</strong></td>
                    <td>
                        GPIO 4: 전면 플래시 LED (SD카드 데이터 핀과 공유)<br>
                        GPIO 33: 후면 작은 빨간색 LED
                    </td>
                </tr>
                <tr>
                    <td><strong>업로드 및 통신 (UART)</strong></td>
                    <td>
                        GPIO 1 (TX0), GPIO 3 (RX0): 코드 업로드/디버깅<br>
                        GPIO 16 (RX2): 수신 전용 (단, PSRAM/카메라 사용 시 불가)
                    </td>
                </tr>
                <tr>
                    <td><strong>부팅(Strapping) 핀</strong><br>(부팅 시 전압 주의)</td>
                    <td>
                        GPIO 0: 부팅 시 HIGH (LOW면 업로드 모드)<br>
                        GPIO 2: 부팅 시 LOW<br>
                        GPIO 12: 부팅 시 LOW<br>
                        GPIO 15: 부팅 시 HIGH
                    </td>
                </tr>
                <tr>
                    <td><strong>카메라/PSRAM 전용</strong><br>(사용 불가)</td>
                    <td>GPIO 5, 18, 19, 21, 22, 23, 25, 26, 27, 32, 34, 35, 36, 39</td>
                </tr>
            </tbody>
        </table>

        <div class="summary-img-container">
            <span class="summary-label">▼ ESP32-CAM 사용 가능한 GPIO 핀 정리</span>
            <img src="image/esp32_cam_gpio_summary.png" alt="ESP32-CAM 사용 가능한 GPIO 핀 정리" class="step-img" style="max-width: 40%;">
        </div>

    </div>

    <script>
        function copyUrl() {
            // URL이 들어있는 code 태그의 텍스트만 가져옵니다.
            const urlText = document.getElementById("esp32-url").innerText;
            
            // 클립보드 API를 사용하여 텍스트를 복사합니다.
            if (navigator.clipboard) {
                navigator.clipboard.writeText(urlText).then(() => {
                    alert("주소가 복사되었습니다!\nArduino IDE에 붙여넣기 하세요."); 
                }).catch(err => {
                    console.error('복사 실패:', err);
                    alert("복사에 실패했습니다. 직접 드래그하여 복사해주세요.");
                });
            } else {
                // 구형 브라우저 대응 (혹시 모를 상황 대비)
                const textArea = document.createElement("textarea");
                textArea.value = urlText;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand("copy");
                document.body.removeChild(textArea);
                alert("주소가 복사되었습니다!");
            }
        }
    </script>

    <script src="css/patch.js"></script>
</body>
</html>
